{"version":3,"sources":["/home/runner/work/ts-utilities/ts-utilities/dist/logger/index.cjs","../../src/logger/index.ts"],"names":["logger","pino"],"mappings":"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","file":"/home/runner/work/ts-utilities/ts-utilities/dist/logger/index.cjs","sourcesContent":[null,"import pino from \"pino\"\n\nimport { gcpPinoLoggerOptions } from \"./gcp-options\"\nimport { Bindings, ILogger, MergingObject } from \"./interface\"\n\nimport type { LoggerOptions } from \"pino\"\n\ntype Environment = \"local\" | \"development\" | \"production\"\n\nconst loggerOptions: Record<Environment, LoggerOptions> = {\n\tlocal: {\n\t\tlevel: process.env.LOG_LEVEL || \"trace\",\n\t\tmessageKey: \"message\",\n\t\ttransport: {\n\t\t\ttarget: \"pino-pretty\",\n\t\t\toptions: {\n\t\t\t\ttranslateTime: \"HH:MM:ss Z\",\n\t\t\t\tignore: \"pid,hostname\",\n\t\t\t},\n\t\t},\n\t},\n\tdevelopment: {\n\t\tlevel: process.env.LOG_LEVEL || \"debug\",\n\n\t\t...gcpPinoLoggerOptions,\n\t},\n\tproduction: {\n\t\tlevel: process.env.LOG_LEVEL || \"info\",\n\t\t...gcpPinoLoggerOptions,\n\t},\n}\n\nexport class PinoAdapter implements ILogger {\n\t// Global default logger\n\tprivate static _logger = new PinoAdapter(\n\t\tpino(loggerOptions[process.env.ENVIRONMENT as Environment] ?? loggerOptions.local),\n\t)\n\n\tstatic get logger(): ILogger {\n\t\treturn PinoAdapter._logger\n\t}\n\n\t// Initialize logger with given environment\n\tstatic init(env: Environment) {\n\t\tconst pinoLogger = pino(loggerOptions[env])\n\t\tPinoAdapter._logger.set(pinoLogger)\n\t\treturn [pinoLogger, PinoAdapter._logger] as const\n\t}\n\n\t// Create a new logger\n\tstatic new(pino: pino.Logger): ILogger {\n\t\treturn new PinoAdapter(pino)\n\t}\n\n\tprivate constructor(private logger: pino.Logger) {}\n\n\twith(bindings: Bindings): ILogger {\n\t\treturn new PinoAdapter(this.logger.child(bindings))\n\t}\n\n\tchild(bindings: Bindings): ILogger {\n\t\treturn new PinoAdapter(this.logger.child(bindings))\n\t}\n\n\tfatal(msg: string, obj?: MergingObject): void {\n\t\tthis.logger.fatal(obj ?? {}, msg)\n\t}\n\n\terror(\n\t\tmsg: string,\n\t\tobj: MergingObject<{\n\t\t\tevent: string\n\t\t\terr: Error | unknown\n\t\t}>,\n\t): void {\n\t\tthis.logger.error(obj ?? {}, msg)\n\t}\n\n\twarn(\n\t\tmsg: string,\n\t\tobj: MergingObject<{\n\t\t\tevent: string\n\t\t}>,\n\t): void {\n\t\tthis.logger.warn(obj ?? {}, msg)\n\t}\n\n\tinfo(msg: string, obj?: MergingObject): void {\n\t\tthis.logger.info(obj ?? {}, msg)\n\t}\n\n\tdebug(msg: string, obj?: MergingObject): void {\n\t\tthis.logger.debug(obj ?? {}, msg)\n\t}\n\n\ttrace(msg: string, obj?: MergingObject): void {\n\t\tthis.logger.trace(obj ?? {}, msg)\n\t}\n\n\tsilent(msg: string, obj?: MergingObject): void {\n\t\tthis.logger.silent(obj ?? {}, msg)\n\t}\n\n\t// replace the underlying pino logger\n\tset(pino: pino.Logger): ILogger {\n\t\tthis.logger = pino\n\t\treturn this\n\t}\n}\n\nexport { pino } // Export pino for consumers who want to customize their own loggers\nexport const logger = PinoAdapter.logger\nexport default logger\n\n/**\n * Initialize logger with given environment\n *\n * @param env Environment\n * @returns [pinoLogger, Logger]\n */\nexport const init = PinoAdapter.init\n\nexport const defaultLoggerOptions = loggerOptions[process.env.ENVIRONMENT as Environment] ?? loggerOptions.local\nexport * from \"./interface\"\n"]}