{"version":3,"sources":["/home/runner/work/ts-utilities/ts-utilities/dist/logger/index.spec.cjs","../../src/logger/index.spec.ts"],"names":[],"mappings":"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","file":"/home/runner/work/ts-utilities/ts-utilities/dist/logger/index.spec.cjs","sourcesContent":[null,"import { describe, expect, it, vi, beforeEach, afterEach } from \"vitest\"\n\nimport { gcpPinoLoggerOptions } from \"./gcp-options\"\n\n// Mock pino\nconst { mockPino } = vi.hoisted(() => {\n\tconst mockInstance = {\n\t\tchild: vi.fn(),\n\t\tfatal: vi.fn(),\n\t\terror: vi.fn(),\n\t\twarn: vi.fn(),\n\t\tinfo: vi.fn(),\n\t\tdebug: vi.fn(),\n\t\ttrace: vi.fn(),\n\t\tsilent: vi.fn(),\n\t\tset: vi.fn(),\n\t}\n\tmockInstance.child.mockReturnValue(mockInstance)\n\treturn {\n\t\tmockPinoInstance: mockInstance,\n\t\tmockPino: vi.fn(() => mockInstance),\n\t}\n})\n\nvi.mock(\"pino\", () => {\n\treturn {\n\t\tdefault: mockPino,\n\t}\n})\n\ndescribe(\"PinoAdapter\", () => {\n\t// Save original env\n\tconst originalEnv = process.env\n\n\tbeforeEach(() => {\n\t\tvi.resetModules()\n\t\tvi.clearAllMocks()\n\t\tprocess.env = { ...originalEnv }\n\t})\n\n\tafterEach(() => {\n\t\tprocess.env = originalEnv\n\t})\n\n\tdescribe(\"init\", () => {\n\t\tit(\"should configure logger for local environment\", async () => {\n\t\t\tconst { PinoAdapter } = await import(\"./index\")\n\t\t\tPinoAdapter.init(\"local\")\n\n\t\t\texpect(mockPino).toHaveBeenCalledWith(\n\t\t\t\texpect.objectContaining({\n\t\t\t\t\tlevel: \"trace\",\n\t\t\t\t\ttransport: {\n\t\t\t\t\t\ttarget: \"pino-pretty\",\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\ttranslateTime: \"HH:MM:ss Z\",\n\t\t\t\t\t\t\tignore: \"pid,hostname\",\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t)\n\t\t})\n\n\t\tit(\"should configure logger for development environment\", async () => {\n\t\t\tconst { PinoAdapter } = await import(\"./index\")\n\t\t\tPinoAdapter.init(\"development\")\n\n\t\t\texpect(mockPino).toHaveBeenLastCalledWith(\n\t\t\t\texpect.objectContaining({\n\t\t\t\t\tlevel: \"debug\",\n\t\t\t\t\tmessageKey: gcpPinoLoggerOptions.messageKey,\n\t\t\t\t}),\n\t\t\t)\n\t\t})\n\n\t\tit(\"should configure logger for production environment\", async () => {\n\t\t\tconst { PinoAdapter } = await import(\"./index\")\n\t\t\tPinoAdapter.init(\"production\")\n\n\t\t\texpect(mockPino).toHaveBeenLastCalledWith(\n\t\t\t\texpect.objectContaining({\n\t\t\t\t\tlevel: \"info\",\n\t\t\t\t\tmessageKey: gcpPinoLoggerOptions.messageKey,\n\t\t\t\t}),\n\t\t\t)\n\t\t})\n\n\t\tit(\"should respect LOG_LEVEL environment variable\", async () => {\n\t\t\tprocess.env.LOG_LEVEL = \"error\"\n\t\t\tconst { PinoAdapter } = await import(\"./index\")\n\t\t\tPinoAdapter.init(\"local\")\n\n\t\t\texpect(mockPino).toHaveBeenCalledWith(\n\t\t\t\texpect.objectContaining({\n\t\t\t\t\tlevel: \"error\",\n\t\t\t\t}),\n\t\t\t)\n\t\t})\n\t})\n})\n"]}