{"version":3,"sources":["/home/runner/work/ts-utilities/ts-utilities/dist/chunk-RWHWC4QP.cjs","../src/utils/errors/index.ts"],"names":["err"],"mappings":"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","file":"/home/runner/work/ts-utilities/ts-utilities/dist/chunk-RWHWC4QP.cjs","sourcesContent":[null,"/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable @typescript-eslint/ban-ts-comment */\nimport { VError } from \"verror\"\n\nfunction unwrap(err: Error | unknown): Error | undefined {\n\tif (!err || typeof err !== \"object\" || !(\"cause\" in err)) return undefined\n\n\t// VError / NError style causes\n\tif (typeof err.cause === \"function\") {\n\t\tconst causeResult = err.cause()\n\t\treturn causeResult instanceof Error ? causeResult : undefined\n\t} else {\n\t\treturn err.cause instanceof Error ? err.cause : undefined\n\t}\n}\n\n/**\n * Finding an error of a specific type within the cause chain.\n */\nfunction findCause<T extends Error>(err: Error | unknown, reference: new (...args: any[]) => T): T | undefined {\n\tif (!(err instanceof Error)) return\n\tif (!err || !reference) return\n\tif (\n\t\t!(reference.prototype instanceof Error) &&\n\t\t// @ts-ignore\n\t\treference !== Error\n\t) {\n\t\treturn\n\t}\n\n\t// Ensures we don't go circular\n\tconst seen = new Set<Error>()\n\n\tlet _err: Error | undefined | null = err\n\twhile (_err && !seen.has(_err)) {\n\t\tseen.add(_err)\n\t\tif (_err instanceof reference) {\n\t\t\treturn _err\n\t\t}\n\n\t\t// VError.MultiError causes\n\t\tif (_err instanceof VError.MultiError) {\n\t\t\tfor (const err of _err.errors()) {\n\t\t\t\tconst result = findCause(err, reference)\n\t\t\t\tif (result) {\n\t\t\t\t\treturn result\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\t_err = unwrap(_err)\n\t\t}\n\t}\n\treturn\n}\n\n/**\n * Golang-like errors utilities.\n */\nexport class errors {\n\t/**\n\t * Finding an error of a specific type within the cause chain.\n\t *\n\t * Support normal error cause (ES2021+) and VError/NError style causes\n\t */\n\tstatic find<T extends Error>(err: Error | unknown, reference: new (...args: any[]) => T): T | undefined {\n\t\treturn findCause(err, reference)\n\t}\n\n\t/**\n\t * Finding an wrapped error is a match of the reference error.\n\t * It's like `errors.Is` in Golang.\n\t *\n\t * Support normal error cause (ES2021+) and VError/NError style causes\n\t *\n\t * @example\n\t * ```ts\n\t * try {\n\t *   await someRecoverableTask().catch((err) => {\n\t *     throw new Error(\"failed to do something\", { cause: err })\n\t *   })\n\t * } catch (err: unknown) {\n\t *   // `true`\n\t *   if (errors.is(err, Error)){\n\t *     console.error(err.message) // auto type inference to `Error`\n\t *   }\n\t *\n\t *   // `true` supports to check chain of errors cause\n\t *   if (errors.is(err, RecoverableError)){\n\t *     console.error(err.message) // auto type inference to `Error`\n\t *   }\n\t * }\n\t * ```\n\t */\n\tstatic is<T extends Error>(err: Error | unknown, reference: new (...args: any[]) => T): err is Error {\n\t\treturn findCause(err, reference) !== undefined\n\t}\n\n\t/**\n\t * Checking and casting an error to a specific type.\n\t * It's like `errors.As` in Golang.\n\t *\n\t * @example\n\t * ```ts\n\t * try {\n\t *   await someRecoverableTask().catch((err) => {\n\t *     throw new HTTPError(401, \"failed to do something\")\n\t *   })\n\t * } catch (err: unknown) {\n\t *   // `true`\n\t *   if (errors.as(err, HTTPError)){\n\t *     console.error(err.code) // type inference to `HTTPError`\n\t *   }\n\t *\n\t *   // `true` because `HTTPError` is inherited from `Error`\n\t *   if (errors.as(err, Error)){\n\t *     console.error(err.message) // type inference to `Error`\n\t *   }\n\t * }\n\t * ```\n\t */\n\tstatic as<T extends Error>(err: Error | unknown, reference: new (...args: any[]) => T): err is T {\n\t\treturn err instanceof reference\n\t}\n\n\t/**\n\t * Unwrapping the error cause.\n\t *\n\t * Support normal error cause (ES2021+) and VError/NError style causes\n\t */\n\tstatic unwrap(err: Error | unknown): Error | undefined {\n\t\tif (!(err instanceof Error)) return undefined\n\t\treturn unwrap(err)\n\t}\n\n\t/**\n\t * Joining multiple errors.\n\t */\n\tstatic join(errs: Error[]): Error | null {\n\t\treturn VError.errorFromList(errs)\n\t}\n\n\tstatic toError(err: unknown): Error {\n\t\tif (err instanceof Error) return err\n\t\tif (!err) return new Error(\"Unknown error\")\n\t\treturn new Error(String(err))\n\t}\n}\n\nexport default errors\n"]}