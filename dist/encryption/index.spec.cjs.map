{"version":3,"sources":["/home/runner/work/ts-utilities/ts-utilities/dist/encryption/index.spec.cjs","../../src/encryption/index.spec.ts"],"names":[],"mappings":"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","file":"/home/runner/work/ts-utilities/ts-utilities/dist/encryption/index.spec.cjs","sourcesContent":[null,"import crypto from \"node:crypto\"\n\nimport { describe, expect, it } from \"vitest\"\n\nimport { EncryptionModule } from \"./index\"\n\ndescribe(\"EncryptionModule\", () => {\n\tconst validKey = \"12345678901234567890123456789012\" // 32 bytes\n\tconst data = new Uint8Array(Buffer.from(\"hello world\"))\n\n\tdescribe(\"aesGcmEncrypt\", () => {\n\t\tit(\"should encrypt data correctly and return ciphertext and nonce\", async () => {\n\t\t\tconst result = await EncryptionModule.aesGcmEncrypt(data, validKey)\n\n\t\t\texpect(result.ciphertext).toBeDefined()\n\t\t\texpect(typeof result.ciphertext).toBe(\"string\")\n\t\t\texpect(result.nonce).toBeDefined()\n\t\t\texpect(result.nonce).toBeInstanceOf(Uint8Array)\n\t\t\texpect(result.nonce.length).toBe(12)\n\t\t})\n\n\t\tit(\"should use provided nonce if given\", async () => {\n\t\t\tconst nonce = crypto.randomBytes(12)\n\t\t\tconst result = await EncryptionModule.aesGcmEncrypt(data, validKey, nonce)\n\n\t\t\texpect(result.nonce).toEqual(new Uint8Array(nonce))\n\t\t})\n\n\t\tit(\"should throw error if key length is invalid\", async () => {\n\t\t\tawait expect(EncryptionModule.aesGcmEncrypt(data, \"invalid-length\")).rejects.toThrow(\n\t\t\t\t\"Encryption key must be exactly 32 bytes for AES-256\",\n\t\t\t)\n\t\t})\n\t})\n\n\tdescribe(\"aesGcmDecrypt\", () => {\n\t\tit(\"should decrypt data correctly\", async () => {\n\t\t\tconst { ciphertext, nonce } = await EncryptionModule.aesGcmEncrypt(data, validKey)\n\n\t\t\tconst decrypted = await EncryptionModule.aesGcmDecrypt(ciphertext, nonce, validKey)\n\n\t\t\texpect(decrypted).toEqual(data)\n\t\t\texpect(Buffer.from(decrypted).toString()).toBe(\"hello world\")\n\t\t})\n\n\t\tit(\"should throw error if key length is invalid\", async () => {\n\t\t\tconst { ciphertext, nonce } = await EncryptionModule.aesGcmEncrypt(data, validKey)\n\n\t\t\tawait expect(EncryptionModule.aesGcmDecrypt(ciphertext, nonce, \"invalid-length\")).rejects.toThrow(\n\t\t\t\t\"Encryption key must be exactly 32 bytes for AES-256\",\n\t\t\t)\n\t\t})\n\n\t\tit(\"should fail to decrypt with wrong key\", async () => {\n\t\t\tconst { ciphertext, nonce } = await EncryptionModule.aesGcmEncrypt(data, validKey)\n\t\t\tconst wrongKey = \"12345678901234567890123456789013\" // 32 bytes different key\n\n\t\t\tawait expect(EncryptionModule.aesGcmDecrypt(ciphertext, nonce, wrongKey)).rejects.toThrow(\n\t\t\t\t\"Failed to decrypt data\",\n\t\t\t)\n\t\t})\n\t})\n})\n"]}