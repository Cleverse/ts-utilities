{"version":3,"sources":["/home/runner/work/ts-utilities/ts-utilities/dist/utils/miscellaneous/sleep.spec.cjs","../../../src/utils/miscellaneous/sleep.spec.ts"],"names":[],"mappings":"AAAA;AACE;AACA;AACF,4DAAiC;AACjC;AACE;AACA;AACA;AACA;AACA;AACA;AACF,4DAAiC;AACjC;AACE;AACF,4DAAiC;AACjC;AACA;AChBA,8CAAA,CAAA;AAIA,wCAAA,qBAAS,EAAuB,CAAA,EAAA,GAAM;AACrC,EAAA,0CAAA,CAAW,EAAA,GAAM;AAChB,IAAA,oBAAA,CAAG,aAAA,CAAc,CAAA;AAAA,EAClB,CAAC,CAAA;AAED,EAAA,yCAAA,CAAU,EAAA,GAAM;AACf,IAAA,oBAAA,CAAG,aAAA,CAAc,CAAA;AAAA,EAClB,CAAC,CAAA;AAED,EAAA,kCAAA,gCAAG,EAAkC,MAAA,CAAA,EAAA,GAAY;AAChD,IAAA,MAAM,GAAA,EAAK,GAAA;AACX,IAAA,MAAM,QAAA,EAAU,qCAAA,EAAQ,CAAA;AAGxB,IAAA,MAAM,SAAA,EAAW,oBAAA,CAAG,EAAA,CAAG,CAAA;AACvB,IAAA,OAAA,CAAQ,IAAA,CAAK,QAAQ,CAAA;AAErB,IAAA,4CAAA,QAAe,CAAA,CAAE,GAAA,CAAI,gBAAA,CAAiB,CAAA;AAGtC,IAAA,MAAM,oBAAA,CAAG,wBAAA,CAAyB,EAAE,CAAA;AAEpC,IAAA,4CAAA,QAAe,CAAA,CAAE,gBAAA,CAAiB,CAAA;AAAA,EACnC,CAAC,CAAA;AAED,EAAA,kCAAA,yDAAG,EAA2D,MAAA,CAAA,EAAA,GAAY;AACzE,IAAA,MAAM,WAAA,EAAa,IAAI,eAAA,CAAgB,CAAA;AACvC,IAAA,UAAA,CAAW,KAAA,CAAM,CAAA;AAEjB,IAAA,MAAM,QAAA,EAAU,qCAAA,GAAM,EAAM,UAAA,CAAW,MAAM,CAAA;AAC7C,IAAA,MAAM,4CAAA,OAAc,CAAA,CAAE,QAAA,CAAS,aAAA,CAAc,CAAA;AAAA,EAC9C,CAAC,CAAA;AAED,EAAA,kCAAA,8CAAG,EAAgD,MAAA,CAAA,EAAA,GAAY;AAC9D,IAAA,MAAM,WAAA,EAAa,IAAI,eAAA,CAAgB,CAAA;AACvC,IAAA,MAAM,GAAA,EAAK,GAAA;AAEX,IAAA,MAAM,QAAA,EAAU,qCAAA,EAAM,EAAI,UAAA,CAAW,MAAM,CAAA;AAG3C,IAAA,MAAM,oBAAA,CAAG,wBAAA,CAAyB,GAAG,CAAA;AAGrC,IAAA,UAAA,CAAW,KAAA,CAAM,CAAA;AAGjB,IAAA,MAAM,4CAAA,OAAc,CAAA,CAAE,QAAA,CAAS,aAAA,CAAc,CAAA;AAAA,EAC9C,CAAC,CAAA;AAED,EAAA,kCAAA,yBAAG,EAA2B,CAAA,EAAA,GAAM;AACnC,IAAA,4CAAA,uBAAY,CAAA,CAAE,IAAA,CAAK,uBAAK,CAAA;AAAA,EACzB,CAAC,CAAA;AACF,CAAC,CAAA","file":"/home/runner/work/ts-utilities/ts-utilities/dist/utils/miscellaneous/sleep.spec.cjs","sourcesContent":[null,"import { describe, expect, it, vi, beforeEach, afterEach } from \"vitest\"\n\nimport { sleep, delay } from \"./sleep\"\n\ndescribe(\"miscellaneous/sleep\", () => {\n\tbeforeEach(() => {\n\t\tvi.useFakeTimers()\n\t})\n\n\tafterEach(() => {\n\t\tvi.useRealTimers()\n\t})\n\n\tit(\"should wait for specified time\", async () => {\n\t\tconst ms = 1000\n\t\tconst promise = sleep(ms)\n\n\t\t// Should not be resolved yet\n\t\tconst resolved = vi.fn()\n\t\tpromise.then(resolved)\n\n\t\texpect(resolved).not.toHaveBeenCalled()\n\n\t\t// Advance time\n\t\tawait vi.advanceTimersByTimeAsync(ms)\n\n\t\texpect(resolved).toHaveBeenCalled()\n\t})\n\n\tit(\"should resolve immediately if signal is already aborted\", async () => {\n\t\tconst controller = new AbortController()\n\t\tcontroller.abort()\n\n\t\tconst promise = sleep(1000, controller.signal)\n\t\tawait expect(promise).resolves.toBeUndefined()\n\t})\n\n\tit(\"should abort sleeping when signal is aborted\", async () => {\n\t\tconst controller = new AbortController()\n\t\tconst ms = 5000\n\n\t\tconst promise = sleep(ms, controller.signal)\n\n\t\t// Advance slightly less than needed\n\t\tawait vi.advanceTimersByTimeAsync(100)\n\n\t\t// Abort\n\t\tcontroller.abort()\n\n\t\t// Should resolve immediately after abort\n\t\tawait expect(promise).resolves.toBeUndefined()\n\t})\n\n\tit(\"should have delay alias\", () => {\n\t\texpect(delay).toBe(sleep)\n\t})\n})\n"]}