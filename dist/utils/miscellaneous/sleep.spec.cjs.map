{"version":3,"sources":["../../../src/utils/miscellaneous/sleep.spec.ts"],"sourcesContent":["import { describe, expect, it, vi, beforeEach, afterEach } from \"vitest\"\n\nimport { sleep, delay } from \"./sleep\"\n\ndescribe(\"miscellaneous/sleep\", () => {\n\tbeforeEach(() => {\n\t\tvi.useFakeTimers()\n\t})\n\n\tafterEach(() => {\n\t\tvi.useRealTimers()\n\t})\n\n\tit(\"should wait for specified time\", async () => {\n\t\tconst ms = 1000\n\t\tconst promise = sleep(ms)\n\n\t\t// Should not be resolved yet\n\t\tconst resolved = vi.fn()\n\t\tpromise.then(resolved)\n\n\t\texpect(resolved).not.toHaveBeenCalled()\n\n\t\t// Advance time\n\t\tawait vi.advanceTimersByTimeAsync(ms)\n\n\t\texpect(resolved).toHaveBeenCalled()\n\t})\n\n\tit(\"should resolve immediately if signal is already aborted\", async () => {\n\t\tconst controller = new AbortController()\n\t\tcontroller.abort()\n\n\t\tconst promise = sleep(1000, controller.signal)\n\t\tawait expect(promise).resolves.toBeUndefined()\n\t})\n\n\tit(\"should abort sleeping when signal is aborted\", async () => {\n\t\tconst controller = new AbortController()\n\t\tconst ms = 5000\n\n\t\tconst promise = sleep(ms, controller.signal)\n\n\t\t// Advance slightly less than needed\n\t\tawait vi.advanceTimersByTimeAsync(100)\n\n\t\t// Abort\n\t\tcontroller.abort()\n\n\t\t// Should resolve immediately after abort\n\t\tawait expect(promise).resolves.toBeUndefined()\n\t})\n\n\tit(\"should have delay alias\", () => {\n\t\texpect(delay).toBe(sleep)\n\t})\n})\n"],"mappings":";AAAA,oBAAgE;AAEhE,mBAA6B;AAAA,IAE7B,wBAAS,uBAAuB,MAAM;AACrC,gCAAW,MAAM;AAChB,qBAAG,cAAc;AAAA,EAClB,CAAC;AAED,+BAAU,MAAM;AACf,qBAAG,cAAc;AAAA,EAClB,CAAC;AAED,wBAAG,kCAAkC,YAAY;AAChD,UAAM,KAAK;AACX,UAAM,cAAU,oBAAM,EAAE;AAGxB,UAAM,WAAW,iBAAG,GAAG;AACvB,YAAQ,KAAK,QAAQ;AAErB,8BAAO,QAAQ,EAAE,IAAI,iBAAiB;AAGtC,UAAM,iBAAG,yBAAyB,EAAE;AAEpC,8BAAO,QAAQ,EAAE,iBAAiB;AAAA,EACnC,CAAC;AAED,wBAAG,2DAA2D,YAAY;AACzE,UAAM,aAAa,IAAI,gBAAgB;AACvC,eAAW,MAAM;AAEjB,UAAM,cAAU,oBAAM,KAAM,WAAW,MAAM;AAC7C,cAAM,sBAAO,OAAO,EAAE,SAAS,cAAc;AAAA,EAC9C,CAAC;AAED,wBAAG,gDAAgD,YAAY;AAC9D,UAAM,aAAa,IAAI,gBAAgB;AACvC,UAAM,KAAK;AAEX,UAAM,cAAU,oBAAM,IAAI,WAAW,MAAM;AAG3C,UAAM,iBAAG,yBAAyB,GAAG;AAGrC,eAAW,MAAM;AAGjB,cAAM,sBAAO,OAAO,EAAE,SAAS,cAAc;AAAA,EAC9C,CAAC;AAED,wBAAG,2BAA2B,MAAM;AACnC,8BAAO,kBAAK,EAAE,KAAK,kBAAK;AAAA,EACzB,CAAC;AACF,CAAC;","names":[]}