{"version":3,"sources":["../../../src/utils/miscellaneous/sleep.spec.ts"],"sourcesContent":["import { describe, expect, it, vi, beforeEach, afterEach } from \"vitest\"\n\nimport { sleep, delay } from \"./sleep\"\n\ndescribe(\"miscellaneous/sleep\", () => {\n\tbeforeEach(() => {\n\t\tvi.useFakeTimers()\n\t})\n\n\tafterEach(() => {\n\t\tvi.useRealTimers()\n\t})\n\n\tit(\"should wait for specified time\", async () => {\n\t\tconst ms = 1000\n\t\tconst promise = sleep(ms)\n\n\t\t// Should not be resolved yet\n\t\tconst resolved = vi.fn()\n\t\tpromise.then(resolved)\n\n\t\texpect(resolved).not.toHaveBeenCalled()\n\n\t\t// Advance time\n\t\tawait vi.advanceTimersByTimeAsync(ms)\n\n\t\texpect(resolved).toHaveBeenCalled()\n\t})\n\n\tit(\"should resolve immediately if signal is already aborted\", async () => {\n\t\tconst controller = new AbortController()\n\t\tcontroller.abort()\n\n\t\tconst promise = sleep(1000, controller.signal)\n\t\tawait expect(promise).resolves.toBeUndefined()\n\t})\n\n\tit(\"should abort sleeping when signal is aborted\", async () => {\n\t\tconst controller = new AbortController()\n\t\tconst ms = 5000\n\n\t\tconst promise = sleep(ms, controller.signal)\n\n\t\t// Advance slightly less than needed\n\t\tawait vi.advanceTimersByTimeAsync(100)\n\n\t\t// Abort\n\t\tcontroller.abort()\n\n\t\t// Should resolve immediately after abort\n\t\tawait expect(promise).resolves.toBeUndefined()\n\t})\n\n\tit(\"should have delay alias\", () => {\n\t\texpect(delay).toBe(sleep)\n\t})\n})\n"],"mappings":";;;;;;;;;;;;;;;AAIA,SAAS,uBAAuB,MAAM;AACrC,aAAW,MAAM;AAChB,OAAG,cAAc;AAAA,EAClB,CAAC;AAED,YAAU,MAAM;AACf,OAAG,cAAc;AAAA,EAClB,CAAC;AAED,KAAG,kCAAkC,YAAY;AAChD,UAAM,KAAK;AACX,UAAM,UAAU,MAAM,EAAE;AAGxB,UAAM,WAAW,GAAG,GAAG;AACvB,YAAQ,KAAK,QAAQ;AAErB,iBAAO,QAAQ,EAAE,IAAI,iBAAiB;AAGtC,UAAM,GAAG,yBAAyB,EAAE;AAEpC,iBAAO,QAAQ,EAAE,iBAAiB;AAAA,EACnC,CAAC;AAED,KAAG,2DAA2D,YAAY;AACzE,UAAM,aAAa,IAAI,gBAAgB;AACvC,eAAW,MAAM;AAEjB,UAAM,UAAU,MAAM,KAAM,WAAW,MAAM;AAC7C,UAAM,aAAO,OAAO,EAAE,SAAS,cAAc;AAAA,EAC9C,CAAC;AAED,KAAG,gDAAgD,YAAY;AAC9D,UAAM,aAAa,IAAI,gBAAgB;AACvC,UAAM,KAAK;AAEX,UAAM,UAAU,MAAM,IAAI,WAAW,MAAM;AAG3C,UAAM,GAAG,yBAAyB,GAAG;AAGrC,eAAW,MAAM;AAGjB,UAAM,aAAO,OAAO,EAAE,SAAS,cAAc;AAAA,EAC9C,CAAC;AAED,KAAG,2BAA2B,MAAM;AACnC,iBAAO,KAAK,EAAE,KAAK,KAAK;AAAA,EACzB,CAAC;AACF,CAAC;","names":[]}