{"version":3,"sources":["/home/runner/work/ts-utilities/ts-utilities/dist/chunk-LGLNXDDW.cjs","../src/logger/gcp-options.ts"],"names":[],"mappings":"AAAA;AACE;AACF,wDAA6B;AAC7B;AACA;ACJA,8CAAA,CAAA;AAIA,IAAM,gBAAA,EAAyC;AAAA,EAC9C,KAAA,EAAO,OAAA;AAAA,EACP,KAAA,EAAO,OAAA;AAAA,EACP,IAAA,EAAM,MAAA;AAAA,EACN,IAAA,EAAM,SAAA;AAAA,EACN,KAAA,EAAO,OAAA;AAAA,EACP,KAAA,EAAO;AACR,CAAA;AAGO,IAAM,qBAAA,EAAsC;AAAA,EAClD,UAAA,EAAY,SAAA;AAAA,EACZ,UAAA,EAAY;AAAA,IACX,KAAA,CAAM,KAAA,EAAe;AACpB,MAAA,MAAM,UAAA,EAAY,KAAA;AAClB,MAAA,MAAM,SAAA,EAAW,eAAA,CAAgB,SAAS,CAAA;AAG1C,MAAA,MAAM,SAAA,EACL,UAAA,IAAc,QAAA,GAAW,UAAA,IAAc,QAAA,EACpC;AAAA,QACA,OAAA,EAAS;AAAA,MACV,EAAA,EACC,CAAC,CAAA;AACL,MAAA,OAAO,EAAE,QAAA,EAAU,GAAG,SAAS,CAAA;AAAA,IAChC,CAAA;AAAA,IAEA,GAAA,CAAI,MAAA,EAAQ;AAEX,MAAA,MAAM,UAAA,EAAY,MAAA;AAClB,MAAA,MAAM,WAAA,kBAAa,SAAA,mBAAU,GAAA,6BAAK,OAAA;AAClC,MAAA,MAAM,UAAA,EAAY,WAAA,EAAa,EAAE,WAAA,EAAa,WAAW,EAAA,EAAI,CAAC,CAAA;AAC9D,MAAA,OAAO,EAAE,GAAG,MAAA,EAAQ,GAAG,UAAU,CAAA;AAAA,IAClC;AAAA,EACD;AACD,CAAA;ADNA;AACA;AACE;AACF,oDAAC","file":"/home/runner/work/ts-utilities/ts-utilities/dist/chunk-LGLNXDDW.cjs","sourcesContent":[null,"import type { Level, LoggerOptions } from \"pino\"\n\n// Map Pino levels to Google Cloud Logging severity levels\n// https://cloud.google.com/logging/docs/reference/v2/rest/v2/LogEntry#LogSeverity\nconst levelToSeverity: Record<Level, string> = {\n\ttrace: \"DEBUG\",\n\tdebug: \"DEBUG\",\n\tinfo: \"INFO\",\n\twarn: \"WARNING\",\n\terror: \"ERROR\",\n\tfatal: \"CRITICAL\",\n}\n\n// https://cloud.google.com/logging/docs/structured-logging#special-payload-fields\nexport const gcpPinoLoggerOptions: LoggerOptions = {\n\tmessageKey: \"message\",\n\tformatters: {\n\t\tlevel(label: string) {\n\t\t\tconst pinoLevel = label as Level\n\t\t\tconst severity = levelToSeverity[pinoLevel]\n\t\t\t// `@type` property tells Error Reporting to track even if there is no `stack_trace`\n\t\t\t// https://cloud.google.com/error-reporting/docs/formatting-error-messages#log-text\n\t\t\tconst typeProp =\n\t\t\t\tpinoLevel === \"error\" || pinoLevel === \"fatal\"\n\t\t\t\t\t? {\n\t\t\t\t\t\t\t\"@type\": \"type.googleapis.com/google.devtools.clouderrorreporting.v1beta1.ReportedErrorEvent\",\n\t\t\t\t\t\t}\n\t\t\t\t\t: {}\n\t\t\treturn { severity, ...typeProp }\n\t\t},\n\n\t\tlog(object) {\n\t\t\t// add stack_trace field to object, if exists. ref: https://cloud.google.com/error-reporting/docs/formatting-error-messages#format-log-entry\n\t\t\tconst logObject = object as { err?: Error }\n\t\t\tconst stackTrace = logObject.err?.stack\n\t\t\tconst stackProp = stackTrace ? { stack_trace: stackTrace } : {}\n\t\t\treturn { ...object, ...stackProp }\n\t\t},\n\t},\n}\n"]}